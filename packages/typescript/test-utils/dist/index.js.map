{"version":3,"sources":["../src/mock-rpc-transport.ts","../src/mock-mongo-transport.ts","../src/mock-rpc-client.ts"],"names":["result"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * MockRpcTransport - A reusable mock RPC transport for testing\n *\n * This class provides a flexible mock implementation of the RpcTransport interface\n * that can be used across different SDK tests. It supports:\n * - Call logging for verification\n * - Custom method handlers\n * - Response delays for async testing\n * - Error simulation\n */\n\nimport type {\n  RpcTransport,\n  CallLogEntry,\n  MockResponse,\n  MockTransportOptions,\n} from './types.js';\n\n/**\n * Base mock RPC transport for testing\n *\n * @example\n * ```typescript\n * const transport = new MockRpcTransport();\n *\n * // Register a custom handler\n * transport.on('myMethod', (arg1, arg2) => ({ result: arg1 + arg2 }));\n *\n * // Make a call\n * const result = await transport.call('myMethod', 1, 2);\n *\n * // Verify calls\n * expect(transport.callLog).toHaveLength(1);\n * expect(transport.callLog[0].method).toBe('myMethod');\n * ```\n */\nexport class MockRpcTransport implements RpcTransport {\n  private _closed = false;\n  private _callLog: CallLogEntry[] = [];\n  private _handlers: Map<string, (...args: unknown[]) => unknown | Promise<unknown>> = new Map();\n  private _mockResponses: Map<string, MockResponse[]> = new Map();\n  private _options: Required<MockTransportOptions>;\n\n  constructor(options: MockTransportOptions = {}) {\n    this._options = {\n      defaultDelay: options.defaultDelay ?? 0,\n      enableCallLog: options.enableCallLog ?? true,\n      handlers: options.handlers ?? {},\n    };\n\n    // Register initial handlers\n    for (const [method, handler] of Object.entries(this._options.handlers)) {\n      this._handlers.set(method, handler);\n    }\n\n    // Register default handlers\n    this._registerDefaultHandlers();\n  }\n\n  /**\n   * Register default handlers for common methods\n   */\n  private _registerDefaultHandlers(): void {\n    // Connection methods\n    this.on('connect', () => ({ ok: 1 }));\n    this.on('ping', () => ({ ok: 1 }));\n    this.on('close', () => ({ ok: 1 }));\n  }\n\n  /**\n   * Get the call log\n   */\n  get callLog(): readonly CallLogEntry[] {\n    return this._callLog;\n  }\n\n  /**\n   * Check if the transport is closed\n   */\n  get isClosed(): boolean {\n    return this._closed;\n  }\n\n  /**\n   * Clear the call log\n   */\n  clearCallLog(): void {\n    this._callLog = [];\n  }\n\n  /**\n   * Register a method handler\n   */\n  on(method: string, handler: (...args: unknown[]) => unknown | Promise<unknown>): this {\n    this._handlers.set(method, handler);\n    return this;\n  }\n\n  /**\n   * Remove a method handler\n   */\n  off(method: string): this {\n    this._handlers.delete(method);\n    return this;\n  }\n\n  /**\n   * Queue a mock response for a method\n   * Responses are consumed in FIFO order\n   */\n  mockResponse(method: string, response: MockResponse): this {\n    const queue = this._mockResponses.get(method) ?? [];\n    queue.push(response);\n    this._mockResponses.set(method, queue);\n    return this;\n  }\n\n  /**\n   * Queue an error response for a method\n   */\n  mockError(method: string, error: Error, delay?: number): this {\n    return this.mockResponse(method, { error, delay });\n  }\n\n  /**\n   * Make an RPC call\n   */\n  async call(method: string, ...args: unknown[]): Promise<unknown> {\n    if (this._closed) {\n      throw new Error('Transport is closed');\n    }\n\n    // Log the call\n    if (this._options.enableCallLog) {\n      this._callLog.push({\n        method,\n        args,\n        timestamp: Date.now(),\n      });\n    }\n\n    // Check for queued mock responses\n    const responseQueue = this._mockResponses.get(method);\n    if (responseQueue && responseQueue.length > 0) {\n      const response = responseQueue.shift()!;\n      if (response.delay) {\n        await this._delay(response.delay);\n      }\n      if (response.error) {\n        throw response.error;\n      }\n      return response.result;\n    }\n\n    // Check for a handler\n    const handler = this._handlers.get(method);\n    if (handler) {\n      if (this._options.defaultDelay > 0) {\n        await this._delay(this._options.defaultDelay);\n      }\n      return handler(...args);\n    }\n\n    throw new Error(`Unknown method: ${method}`);\n  }\n\n  /**\n   * Close the transport\n   */\n  async close(): Promise<void> {\n    this._closed = true;\n  }\n\n  /**\n   * Reset the transport to initial state\n   */\n  reset(): void {\n    this._closed = false;\n    this._callLog = [];\n    this._mockResponses.clear();\n  }\n\n  /**\n   * Helper to create a delay\n   */\n  private _delay(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  /**\n   * Get calls for a specific method\n   */\n  getCallsForMethod(method: string): CallLogEntry[] {\n    return this._callLog.filter(entry => entry.method === method);\n  }\n\n  /**\n   * Check if a method was called\n   */\n  wasMethodCalled(method: string): boolean {\n    return this._callLog.some(entry => entry.method === method);\n  }\n\n  /**\n   * Get the last call for a method\n   */\n  getLastCall(method: string): CallLogEntry | undefined {\n    const calls = this.getCallsForMethod(method);\n    return calls[calls.length - 1];\n  }\n}\n","/**\n * MockMongoTransport - A MongoDB-specific mock transport with in-memory storage\n *\n * This provides a full in-memory MongoDB implementation for testing MongoDB SDK code\n * without needing a real database connection.\n */\n\nimport { MockRpcTransport } from './mock-rpc-transport.js';\nimport type { Document } from './types.js';\n\n/**\n * MongoDB-specific mock transport with in-memory storage\n */\nexport class MockMongoTransport extends MockRpcTransport {\n  private _data: Map<string, Map<string, Document[]>> = new Map();\n  private _nextId = 1;\n\n  constructor() {\n    super();\n    this._registerMongoHandlers();\n  }\n\n  /**\n   * Register MongoDB-specific method handlers\n   */\n  private _registerMongoHandlers(): void {\n    // Insert operations\n    this.on('insertOne', (dbName: unknown, collName: unknown, doc: unknown) => {\n      const collection = this._getOrCreateCollection(String(dbName), String(collName));\n      const document = doc as Document;\n      const id = document._id ?? `id_${this._nextId++}`;\n      collection.push({ ...document, _id: id });\n      return { acknowledged: true, insertedId: id };\n    });\n\n    this.on('insertMany', (dbName: unknown, collName: unknown, docs: unknown) => {\n      const collection = this._getOrCreateCollection(String(dbName), String(collName));\n      const documents = docs as Document[];\n      const insertedIds: Record<number, string> = {};\n      documents.forEach((doc, i) => {\n        const id = doc._id ?? `id_${this._nextId++}`;\n        collection.push({ ...doc, _id: id });\n        insertedIds[i] = String(id);\n      });\n      return { acknowledged: true, insertedCount: documents.length, insertedIds };\n    });\n\n    // Find operations\n    this.on('find', (dbName: unknown, collName: unknown, filter: unknown, options: unknown) => {\n      const collection = this._getCollection(String(dbName), String(collName));\n      const filterDoc = (filter as Document) ?? {};\n      const opts = (options as Document) ?? {};\n      let results = collection.filter(doc => this._matchesFilter(doc, filterDoc));\n\n      if (opts.sort) {\n        results = this._sortDocs(results, opts.sort as Record<string, 1 | -1>);\n      }\n      if (opts.skip) {\n        results = results.slice(opts.skip as number);\n      }\n      if (opts.limit !== undefined) {\n        results = results.slice(0, opts.limit as number);\n      }\n      if (opts.projection) {\n        results = results.map(doc => this._applyProjection(doc, opts.projection as Record<string, 0 | 1>));\n      }\n\n      return results;\n    });\n\n    // Update operations\n    this.on('updateOne', (dbName: unknown, collName: unknown, filter: unknown, update: unknown, options: unknown) => {\n      const collection = this._getCollection(String(dbName), String(collName));\n      const filterDoc = filter as Document;\n      const updateDoc = update as Document;\n      const opts = (options as Document) ?? {};\n      const index = collection.findIndex(doc => this._matchesFilter(doc, filterDoc));\n\n      if (index === -1) {\n        if (opts.upsert) {\n          const id = `id_${this._nextId++}`;\n          const newDoc = { _id: id, ...this._applyUpdate({}, updateDoc) };\n          collection.push(newDoc);\n          return { acknowledged: true, matchedCount: 0, modifiedCount: 0, upsertedId: id, upsertedCount: 1 };\n        }\n        return { acknowledged: true, matchedCount: 0, modifiedCount: 0 };\n      }\n\n      collection[index] = this._applyUpdate(collection[index], updateDoc);\n      return { acknowledged: true, matchedCount: 1, modifiedCount: 1 };\n    });\n\n    this.on('updateMany', (dbName: unknown, collName: unknown, filter: unknown, update: unknown, options: unknown) => {\n      const collection = this._getCollection(String(dbName), String(collName));\n      const filterDoc = filter as Document;\n      const updateDoc = update as Document;\n      const opts = (options as Document) ?? {};\n      let matchedCount = 0;\n      let modifiedCount = 0;\n\n      collection.forEach((doc, i) => {\n        if (this._matchesFilter(doc, filterDoc)) {\n          matchedCount++;\n          const updated = this._applyUpdate(doc, updateDoc);\n          if (JSON.stringify(updated) !== JSON.stringify(doc)) {\n            collection[i] = updated;\n            modifiedCount++;\n          }\n        }\n      });\n\n      if (matchedCount === 0 && opts.upsert) {\n        const id = `id_${this._nextId++}`;\n        const newDoc = { _id: id, ...this._applyUpdate({}, updateDoc) };\n        collection.push(newDoc);\n        return { acknowledged: true, matchedCount: 0, modifiedCount: 0, upsertedId: id, upsertedCount: 1 };\n      }\n\n      return { acknowledged: true, matchedCount, modifiedCount };\n    });\n\n    // Delete operations\n    this.on('deleteOne', (dbName: unknown, collName: unknown, filter: unknown) => {\n      const collection = this._getCollection(String(dbName), String(collName));\n      const filterDoc = filter as Document;\n      const index = collection.findIndex(doc => this._matchesFilter(doc, filterDoc));\n\n      if (index === -1) {\n        return { acknowledged: true, deletedCount: 0 };\n      }\n\n      collection.splice(index, 1);\n      return { acknowledged: true, deletedCount: 1 };\n    });\n\n    this.on('deleteMany', (dbName: unknown, collName: unknown, filter: unknown) => {\n      const collection = this._getCollection(String(dbName), String(collName));\n      const filterDoc = filter as Document;\n      const toDelete: number[] = [];\n\n      collection.forEach((doc, i) => {\n        if (this._matchesFilter(doc, filterDoc)) {\n          toDelete.push(i);\n        }\n      });\n\n      // Delete in reverse order to maintain indices\n      for (let i = toDelete.length - 1; i >= 0; i--) {\n        collection.splice(toDelete[i], 1);\n      }\n\n      return { acknowledged: true, deletedCount: toDelete.length };\n    });\n\n    // Count operations\n    this.on('countDocuments', (dbName: unknown, collName: unknown, filter: unknown, options: unknown) => {\n      const collection = this._getCollection(String(dbName), String(collName));\n      const filterDoc = (filter as Document) ?? {};\n      const opts = (options as Document) ?? {};\n      let results = collection.filter(doc => this._matchesFilter(doc, filterDoc));\n\n      if (opts.skip) {\n        results = results.slice(opts.skip as number);\n      }\n      if (opts.limit) {\n        results = results.slice(0, opts.limit as number);\n      }\n\n      return results.length;\n    });\n\n    this.on('estimatedDocumentCount', (dbName: unknown, collName: unknown) => {\n      const collection = this._getCollection(String(dbName), String(collName));\n      return collection.length;\n    });\n\n    // Aggregation\n    this.on('aggregate', (dbName: unknown, collName: unknown, pipeline: unknown) => {\n      let results = [...this._getCollection(String(dbName), String(collName))];\n      const stages = pipeline as Document[];\n\n      for (const stage of stages) {\n        if (stage.$match) {\n          results = results.filter(doc => this._matchesFilter(doc, stage.$match as Document));\n        } else if (stage.$limit) {\n          results = results.slice(0, stage.$limit as number);\n        } else if (stage.$skip) {\n          results = results.slice(stage.$skip as number);\n        } else if (stage.$sort) {\n          results = this._sortDocs(results, stage.$sort as Record<string, 1 | -1>);\n        } else if (stage.$project) {\n          results = results.map(doc => this._applyProjection(doc, stage.$project as Record<string, 0 | 1>));\n        } else if (stage.$count) {\n          results = [{ [stage.$count as string]: results.length }];\n        } else if (stage.$group) {\n          results = this._groupDocs(results, stage.$group as Document);\n        }\n      }\n\n      return results;\n    });\n\n    // Collection management\n    this.on('createCollection', (dbName: unknown, collName: unknown) => {\n      this._getOrCreateCollection(String(dbName), String(collName));\n      return { ok: 1 };\n    });\n\n    this.on('dropCollection', (dbName: unknown, collName: unknown) => {\n      const db = this._data.get(String(dbName));\n      if (db) {\n        db.delete(String(collName));\n      }\n      return true;\n    });\n\n    this.on('dropDatabase', (dbName: unknown) => {\n      this._data.delete(String(dbName));\n      return true;\n    });\n\n    this.on('listCollections', (dbName: unknown) => {\n      const db = this._data.get(String(dbName));\n      if (!db) return [];\n      return Array.from(db.keys()).map(name => ({ name, type: 'collection' }));\n    });\n\n    this.on('listDatabases', () => {\n      const databases = Array.from(this._data.keys()).map(name => ({\n        name,\n        sizeOnDisk: 0,\n        empty: (this._data.get(name)?.size ?? 0) === 0,\n      }));\n      return { databases, totalSize: 0 };\n    });\n\n    // Index operations (stubs)\n    this.on('createIndex', () => 'index_name');\n    this.on('createIndexes', () => ['index_1', 'index_2']);\n    this.on('dropIndex', () => undefined);\n    this.on('dropIndexes', () => undefined);\n    this.on('listIndexes', () => [{ v: 2, key: { _id: 1 }, name: '_id_' }]);\n\n    // Server operations\n    this.on('serverStatus', () => ({ host: 'localhost', version: '1.0.0', ok: 1 }));\n    this.on('adminCommand', () => ({ ok: 1 }));\n    this.on('runCommand', (_dbName: unknown, command: unknown) => {\n      const cmd = command as Document;\n      if (cmd.dbStats) {\n        return { db: _dbName, collections: 0, objects: 0, avgObjSize: 0, dataSize: 0, storageSize: 0, indexes: 0, indexSize: 0, ok: 1 };\n      }\n      return { ok: 1 };\n    });\n  }\n\n  /**\n   * Get all data (for debugging)\n   */\n  getData(): Map<string, Map<string, Document[]>> {\n    return this._data;\n  }\n\n  /**\n   * Clear all data\n   */\n  clearData(): void {\n    this._data.clear();\n    this._nextId = 1;\n  }\n\n  /**\n   * Seed data for testing\n   */\n  seedData(dbName: string, collName: string, documents: Document[]): void {\n    const collection = this._getOrCreateCollection(dbName, collName);\n    documents.forEach(doc => {\n      const id = doc._id ?? `id_${this._nextId++}`;\n      collection.push({ ...doc, _id: id });\n    });\n  }\n\n  // Private helper methods\n\n  private _getOrCreateDb(name: string): Map<string, Document[]> {\n    let db = this._data.get(name);\n    if (!db) {\n      db = new Map();\n      this._data.set(name, db);\n    }\n    return db;\n  }\n\n  private _getOrCreateCollection(dbName: string, collName: string): Document[] {\n    const db = this._getOrCreateDb(dbName);\n    let collection = db.get(collName);\n    if (!collection) {\n      collection = [];\n      db.set(collName, collection);\n    }\n    return collection;\n  }\n\n  private _getCollection(dbName: string, collName: string): Document[] {\n    return this._getOrCreateCollection(dbName, collName);\n  }\n\n  private _matchesFilter(doc: Document, filter: Document): boolean {\n    if (!filter || Object.keys(filter).length === 0) {\n      return true;\n    }\n\n    for (const [key, value] of Object.entries(filter)) {\n      // Handle special operators\n      if (key === '$and') {\n        if (!Array.isArray(value)) return false;\n        if (!value.every((f: Document) => this._matchesFilter(doc, f))) return false;\n        continue;\n      }\n      if (key === '$or') {\n        if (!Array.isArray(value)) return false;\n        if (!value.some((f: Document) => this._matchesFilter(doc, f))) return false;\n        continue;\n      }\n\n      const docValue = this._getFieldValue(doc, key);\n\n      // Handle operator objects\n      if (value !== null && typeof value === 'object' && !Array.isArray(value)) {\n        const operators = value as Record<string, unknown>;\n        let allMatch = true;\n\n        for (const [op, opValue] of Object.entries(operators)) {\n          if (!op.startsWith('$')) {\n            if (!this._compareValues(docValue, value)) {\n              allMatch = false;\n              break;\n            }\n            continue;\n          }\n\n          switch (op) {\n            case '$eq':\n              if (!this._compareValues(docValue, opValue)) allMatch = false;\n              break;\n            case '$ne':\n              if (this._compareValues(docValue, opValue)) allMatch = false;\n              break;\n            case '$gt':\n              if (docValue === undefined || docValue === null || (docValue as number) <= (opValue as number)) allMatch = false;\n              break;\n            case '$gte':\n              if (docValue === undefined || docValue === null || (docValue as number) < (opValue as number)) allMatch = false;\n              break;\n            case '$lt':\n              if (docValue === undefined || docValue === null || (docValue as number) >= (opValue as number)) allMatch = false;\n              break;\n            case '$lte':\n              if (docValue === undefined || docValue === null || (docValue as number) > (opValue as number)) allMatch = false;\n              break;\n            case '$in':\n              if (!Array.isArray(opValue) || !opValue.some(v => this._compareValues(docValue, v))) allMatch = false;\n              break;\n            case '$nin':\n              if (!Array.isArray(opValue) || opValue.some(v => this._compareValues(docValue, v))) allMatch = false;\n              break;\n            case '$exists':\n              if ((opValue && docValue === undefined) || (!opValue && docValue !== undefined)) allMatch = false;\n              break;\n            case '$regex': {\n              const pattern = typeof opValue === 'string' ? opValue : String(opValue);\n              const flags = operators.$options as string | undefined;\n              const regex = new RegExp(pattern, flags);\n              if (typeof docValue !== 'string' || !regex.test(docValue)) allMatch = false;\n              break;\n            }\n          }\n\n          if (!allMatch) break;\n        }\n\n        if (!allMatch) return false;\n      } else {\n        // Direct value comparison\n        if (!this._compareValues(docValue, value)) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  private _getFieldValue(doc: Document, path: string): unknown {\n    const parts = path.split('.');\n    let value: unknown = doc;\n\n    for (const part of parts) {\n      if (value === null || value === undefined) return undefined;\n      if (typeof value !== 'object') return undefined;\n      value = (value as Record<string, unknown>)[part];\n    }\n\n    return value;\n  }\n\n  private _setFieldValue(doc: Document, path: string, value: unknown): void {\n    const parts = path.split('.');\n    let current: Record<string, unknown> = doc;\n\n    for (let i = 0; i < parts.length - 1; i++) {\n      const part = parts[i];\n      if (current[part] === undefined || current[part] === null) {\n        current[part] = {};\n      }\n      current = current[part] as Record<string, unknown>;\n    }\n\n    current[parts[parts.length - 1]] = value;\n  }\n\n  private _compareValues(a: unknown, b: unknown): boolean {\n    if (a === b) return true;\n    if (a === null || b === null) return a === b;\n    if (a === undefined || b === undefined) return a === b;\n\n    if (Array.isArray(a) && Array.isArray(b)) {\n      if (a.length !== b.length) return false;\n      return a.every((v, i) => this._compareValues(v, b[i]));\n    }\n\n    if (typeof a === 'object' && typeof b === 'object') {\n      const keysA = Object.keys(a as object);\n      const keysB = Object.keys(b as object);\n      if (keysA.length !== keysB.length) return false;\n      return keysA.every(key => this._compareValues((a as Record<string, unknown>)[key], (b as Record<string, unknown>)[key]));\n    }\n\n    return false;\n  }\n\n  private _sortDocs(docs: Document[], sort: Record<string, 1 | -1>): Document[] {\n    return [...docs].sort((a, b) => {\n      for (const [key, direction] of Object.entries(sort)) {\n        const aVal = this._getFieldValue(a, key);\n        const bVal = this._getFieldValue(b, key);\n\n        if (aVal === bVal) continue;\n        if (aVal === undefined || aVal === null) return direction;\n        if (bVal === undefined || bVal === null) return -direction;\n\n        if (aVal < bVal) return -direction;\n        if (aVal > bVal) return direction;\n      }\n      return 0;\n    });\n  }\n\n  private _applyProjection(doc: Document, projection: Record<string, 0 | 1>): Document {\n    const hasInclusion = Object.values(projection).some(v => v === 1);\n\n    if (hasInclusion) {\n      const result: Document = projection._id !== 0 ? { _id: doc._id } : {};\n      for (const [key, value] of Object.entries(projection)) {\n        if (value === 1) {\n          result[key] = this._getFieldValue(doc, key);\n        }\n      }\n      return result;\n    }\n\n    // Exclusion only\n    const result = { ...doc };\n    for (const [key, value] of Object.entries(projection)) {\n      if (value === 0) {\n        delete result[key];\n      }\n    }\n    return result;\n  }\n\n  private _applyUpdate(doc: Document, update: Document): Document {\n    const result = { ...doc };\n\n    if (update.$set) {\n      for (const [key, value] of Object.entries(update.$set as Record<string, unknown>)) {\n        this._setFieldValue(result, key, value);\n      }\n    }\n\n    if (update.$unset) {\n      for (const key of Object.keys(update.$unset as Record<string, unknown>)) {\n        delete result[key];\n      }\n    }\n\n    if (update.$inc) {\n      for (const [key, value] of Object.entries(update.$inc as Record<string, number>)) {\n        const current = this._getFieldValue(result, key);\n        this._setFieldValue(result, key, (typeof current === 'number' ? current : 0) + value);\n      }\n    }\n\n    if (update.$push) {\n      for (const [key, value] of Object.entries(update.$push as Record<string, unknown>)) {\n        let current = this._getFieldValue(result, key);\n        if (!Array.isArray(current)) {\n          current = [];\n          this._setFieldValue(result, key, current);\n        }\n        (current as unknown[]).push(value);\n      }\n    }\n\n    if (update.$addToSet) {\n      for (const [key, value] of Object.entries(update.$addToSet as Record<string, unknown>)) {\n        let current = this._getFieldValue(result, key);\n        if (!Array.isArray(current)) {\n          current = [];\n          this._setFieldValue(result, key, current);\n        }\n        const arr = current as unknown[];\n        if (!arr.some(v => this._compareValues(v, value))) {\n          arr.push(value);\n        }\n      }\n    }\n\n    if (update.$pull) {\n      for (const [key, value] of Object.entries(update.$pull as Record<string, unknown>)) {\n        const current = this._getFieldValue(result, key);\n        if (Array.isArray(current)) {\n          const filtered = current.filter(item => !this._compareValues(item, value));\n          this._setFieldValue(result, key, filtered);\n        }\n      }\n    }\n\n    return result;\n  }\n\n  private _groupDocs(docs: Document[], groupSpec: Document): Document[] {\n    const groups = new Map<string, { key: unknown; docs: Document[] }>();\n\n    for (const doc of docs) {\n      const keyValue = groupSpec._id === null ? null : this._evaluateExpression(doc, groupSpec._id);\n      const keyStr = JSON.stringify(keyValue);\n\n      if (!groups.has(keyStr)) {\n        groups.set(keyStr, { key: keyValue, docs: [] });\n      }\n      groups.get(keyStr)!.docs.push(doc);\n    }\n\n    const results: Document[] = [];\n\n    for (const [, { key, docs: groupDocs }] of groups) {\n      const result: Document = { _id: key };\n\n      for (const [field, spec] of Object.entries(groupSpec)) {\n        if (field === '_id') continue;\n\n        if (typeof spec === 'object' && spec !== null) {\n          const accSpec = spec as Record<string, unknown>;\n\n          if ('$sum' in accSpec) {\n            if (accSpec.$sum === 1) {\n              result[field] = groupDocs.length;\n            } else {\n              result[field] = groupDocs.reduce((sum, d) => sum + (this._evaluateExpression(d, accSpec.$sum) as number), 0);\n            }\n          } else if ('$avg' in accSpec) {\n            const values = groupDocs.map(d => this._evaluateExpression(d, accSpec.$avg) as number);\n            result[field] = values.reduce((a, b) => a + b, 0) / values.length;\n          } else if ('$min' in accSpec) {\n            result[field] = Math.min(...groupDocs.map(d => this._evaluateExpression(d, accSpec.$min) as number));\n          } else if ('$max' in accSpec) {\n            result[field] = Math.max(...groupDocs.map(d => this._evaluateExpression(d, accSpec.$max) as number));\n          } else if ('$first' in accSpec) {\n            result[field] = groupDocs.length > 0 ? this._evaluateExpression(groupDocs[0], accSpec.$first) : null;\n          } else if ('$last' in accSpec) {\n            result[field] = groupDocs.length > 0 ? this._evaluateExpression(groupDocs[groupDocs.length - 1], accSpec.$last) : null;\n          }\n        }\n      }\n\n      results.push(result);\n    }\n\n    return results;\n  }\n\n  private _evaluateExpression(doc: Document, expr: unknown): unknown {\n    if (expr === null) return null;\n\n    if (typeof expr === 'string') {\n      if (expr.startsWith('$')) {\n        return this._getFieldValue(doc, expr.substring(1));\n      }\n      return expr;\n    }\n\n    return expr;\n  }\n}\n","/**\n * MockRpcClient - A mock RPC client for testing the $ proxy pattern\n *\n * This provides a mock implementation that supports the $ proxy pattern\n * used in Kafka and other SDKs.\n */\n\nimport type { RpcClient, RpcClientFactory, CallLogEntry } from './types.js';\n\n/**\n * Options for creating a mock RPC client\n */\nexport interface MockRpcClientOptions {\n  /** Default response for unhandled methods */\n  defaultResponse?: unknown;\n  /** Custom method handlers */\n  handlers?: Record<string, (...args: unknown[]) => unknown | Promise<unknown>>;\n  /** Enable call logging */\n  enableCallLog?: boolean;\n}\n\n/**\n * Create a mock RPC client with the $ proxy pattern\n */\nexport function createMockRpcClient(options: MockRpcClientOptions = {}): RpcClient & {\n  callLog: CallLogEntry[];\n  clearCallLog: () => void;\n  on: (method: string, handler: (...args: unknown[]) => unknown | Promise<unknown>) => void;\n} {\n  const handlers = new Map<string, (...args: unknown[]) => unknown | Promise<unknown>>();\n  const callLog: CallLogEntry[] = [];\n  const enableCallLog = options.enableCallLog ?? true;\n\n  // Register initial handlers\n  if (options.handlers) {\n    for (const [method, handler] of Object.entries(options.handlers)) {\n      handlers.set(method, handler);\n    }\n  }\n\n  const $proxy = new Proxy({} as Record<string, (...args: unknown[]) => Promise<unknown>>, {\n    get: (_target, method: string) => {\n      return async (...args: unknown[]): Promise<unknown> => {\n        if (enableCallLog) {\n          callLog.push({\n            method,\n            args,\n            timestamp: Date.now(),\n          });\n        }\n\n        const handler = handlers.get(method);\n        if (handler) {\n          return handler(...args);\n        }\n\n        return options.defaultResponse ?? {};\n      };\n    },\n  });\n\n  return {\n    $: $proxy,\n    close: async () => {},\n    callLog,\n    clearCallLog: () => {\n      callLog.length = 0;\n    },\n    on: (method: string, handler: (...args: unknown[]) => unknown | Promise<unknown>) => {\n      handlers.set(method, handler);\n    },\n  };\n}\n\n/** Extended mock RPC client type */\nexport type MockRpcClientExtended = RpcClient & {\n  callLog: CallLogEntry[];\n  clearCallLog: () => void;\n  on: (method: string, handler: (...args: unknown[]) => unknown | Promise<unknown>) => void;\n};\n\n/** Extended factory type with tracking */\nexport interface MockRpcClientFactoryExtended {\n  (url: string): MockRpcClientExtended;\n  clients: Map<string, MockRpcClientExtended>;\n  getClient: (url: string) => MockRpcClientExtended | undefined;\n}\n\n/**\n * Create a mock RPC client factory\n *\n * @example\n * ```typescript\n * const mockFactory = createMockRpcClientFactory({\n *   handlers: {\n *     'produce': async (topic, messages) => ({ offsets: [{ partition: 0, offset: '0' }] }),\n *   },\n * });\n *\n * setRpcClientFactory(mockFactory);\n * ```\n */\nexport function createMockRpcClientFactory(\n  options: MockRpcClientOptions = {}\n): MockRpcClientFactoryExtended {\n  const clients = new Map<string, MockRpcClientExtended>();\n\n  const factory: MockRpcClientFactoryExtended = Object.assign(\n    (url: string): MockRpcClientExtended => {\n      const client = createMockRpcClient(options);\n      clients.set(url, client);\n      return client;\n    },\n    {\n      clients,\n      getClient: (url: string) => clients.get(url),\n    }\n  );\n\n  return factory;\n}\n"]}